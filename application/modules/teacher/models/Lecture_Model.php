<?phpif (!defined('BASEPATH'))    exit('No direct script access allowed');class Lecture_Model extends MY_Model {        function __construct() {        parent::__construct();    }         public function get_lecture_list($school_id = null, $academic_year_id = null, $class_id = null, $section_id = null){                 $this->db->select('L.*, T.name AS teacher, SC.school_name, C.School_className AS class_name, SE.name AS section, S.sub_name AS subject, AY.session_year');        $this->db->from('video_lectures AS L');        $this->db->join('teachers AS T', 'T.id = L.teacher_id', 'left');      //  $this->db->join('classes AS C', 'C.id = L.class_id', 'left');                 $this->db->join('schoolclass AS C', 'C.School_classesid = L.class_id', 'left');        $this->db->join('sections AS SE', 'SE.id = L.section_id', 'left');       // $this->db->join('subjects AS S', 'S.id = L.subject_id', 'left');                  $this->db->join('sub_list AS S', 'S.id = L.subject_id', 'left');        $this->db->join('academic_years AS AY', 'AY.id = L.academic_year_id', 'left');        $this->db->join('schools AS SC', 'SC.id = L.school_id', 'left');          if ($this->session->userdata('role_id') == ADMIN || $this->session->userdata('role_id') == GUARDIAN || $this->session->userdata('role_id') == STUDENT || $this->session->userdata('role_id') == TEACHER || $this->session->userdata('role_id') == ACCOUNTANT || $this->session->userdata('role_id') == LIBRARIN || $this->session->userdata('role_id') == RECEPTIONIST || $this->session->userdata('role_id') == STAFF) {            $this->db->where('L.school_id', $this->session->userdata('school_id'));              if($academic_year_id){            $this->db->where('L.academic_year_id', $academic_year_id);        }                        if ($class_id) {                $this->db->where('L.class_id', $class_id);            }                                    if($this->session->userdata('role_id') == TEACHER){            $this->db->where('L.teacher_id', $this->session->userdata('profile_id'));        }		 	if($this->session->userdata('role_id') == STUDENT){            $this->db->where('L.section_id', $this->session->userdata('section_id'));        }                    } else {////            if ($province_id) {////                $this->db->where('SC.provincial', $province_id);//            }//////            if ($district_id) {////                $this->db->where('SC.district_id', $district_id);//            }//////            if ($zonal_id) {////                $this->db->where('SC.zonal_id', $zonal_id);//            }//////            if ($edu_id) {////                $this->db->where('SC.educational_id', $edu_id);//            }//            if ($school_id) {                  $this->db->where('L.school_id', $school_id);             }                                               if($academic_year_id){            $this->db->where('L.academic_year_id', $academic_year_id);        }                if($class_id){             $this->db->where('L.class_id', $class_id);        }         if($section_id){             $this->db->where('L.section_id', $section_id);        }         }                                        //        if($school_id && $this->session->userdata('role_id') == SUPER_ADMIN){////            $this->db->where('L.school_id', $school_id); ////        }        ////        if($this->session->userdata('role_id') != SUPER_ADMIN){////            $this->db->where('L.school_id', $this->session->userdata('school_id'));////        }	    if ($this->session->userdata('role_id') == SUBJECT) {            $subject_id = $this->session->userdata('subject_id');            $str_area = explode(',', $subject_id);            $this->db->where_in('L.subject_id', $str_area);        }        if ($this->session->userdata('role_id') == PROVINCIAL) {            $provincial_id = $this->session->userdata('provincial_id');            $this->db->where('SC.provincial', $provincial_id);        }        if ($this->session->userdata('role_id') == ZONAL) {            $zonal_id = $this->session->userdata('zonal_id');            $str_area = explode(',', $zonal_id);            $this->db->where_in('SC.zonal_id', $str_area);        }		 	$this->db->where('SC.status', 1);	         $this->db->order_by('L.id', 'DESC');                        return $this->db->get()->result();            }            public function get_single_lecture($id){                $this->db->select('L.*, T.name AS teacher, SC.school_name, C.School_className AS class_name, SE.name AS section, S.name AS subject, AY.session_year');        $this->db->from('video_lectures AS L');        $this->db->join('teachers AS T', 'T.id = L.teacher_id', 'left');       // $this->db->join('classes AS C', 'C.id = L.class_id', 'left');                 $this->db->join('schoolclass AS C', 'C.School_classesid = L.class_id', 'left');        $this->db->join('sections AS SE', 'SE.id = L.section_id', 'left');        $this->db->join('subjects AS S', 'S.id = L.subject_id', 'left');        $this->db->join('academic_years AS AY', 'AY.id = L.academic_year_id', 'left');        $this->db->join('schools AS SC', 'SC.id = L.school_id', 'left');        $this->db->where('L.id', $id);        return $this->db->get()->row();                }         public function get_teacher_by_subject($school_id = null, $class_id = null){                $this->db->select('T.*');        $this->db->join('subjects AS S', 'S.teacher_id = T.id', 'left');        $this->db->join('schools AS SC', 'SC.id = T.school_id', 'left');                if($school_id && $this->session->userdata('role_id') == SUPER_ADMIN){            $this->db->where('T.school_id', $school_id);         }                if($this->session->userdata('role_id') != SUPER_ADMIN){            $this->db->where('T.school_id', $this->session->userdata('school_id'));        }                if($class_id){            $this->db->where('S.class_id', $class_id);        }                $this->db->order_by('T.id', 'DESC');                        return $this->db->get()->result();    }        public function getclassData($School_TypeId = null) {//        $this->db->select('schoolclass.School_classesid,schoolclass.School_className');        $this->db->from('schoolclass');        $this->db->where('schoolclass.School_Typeid', $School_TypeId);//        $query = $this->db->get();        return $query->result();    }                    public function getdistrictData($provincial_id = null) {//        $this->db->select('district.id,district.districtname');        $this->db->from('district');        $this->db->where('district.provinceid', $provincial_id);//        $query = $this->db->get();        return $query->result();    }                public function getzonalData($zonal_id = null) {        $str_area = explode(',', $zonal_id);//        $this->db->select('zoneblock.zoneblockid,zoneblock.zoneblock');        $this->db->from('zoneblock');        $this->db->where_in('zoneblock.zoneid', $str_area);//        $query = $this->db->get();        return $query->result();    }}