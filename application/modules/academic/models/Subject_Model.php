<?phpif (!defined('BASEPATH'))    exit('No direct script access allowed');class Subject_Model extends MY_Model {    function __construct() {        parent::__construct();    }    public function get_subject_list($province_id = null, $district_id = null, $zonal_id = null, $edu_id = null, $schools_id = null,$class_id = null) {        if (!$class_id) {            $class_id = $this->session->userdata('class_id');        }        $this->db->select('S.*, SC.school_name, C.School_className AS class_name, T.name AS teacher');        $this->db->from('subjects AS S');        $this->db->join('teachers AS T', 'T.id = S.teacher_id', 'left');        $this->db->join('schoolclass AS C', 'C.School_classesid = S.class_id', 'left');        $this->db->join('schools AS SC', 'SC.id = S.school_id', 'left');          if ($this->session->userdata('role_id') == ADMIN || $this->session->userdata('role_id') == GUARDIAN || $this->session->userdata('role_id') == STUDENT  || $this->session->userdata('role_id') == ACCOUNTANT || $this->session->userdata('role_id') == LIBRARIN || $this->session->userdata('role_id') == RECEPTIONIST || $this->session->userdata('role_id') == STAFF) {            $this->db->where('S.school_id', $this->session->userdata('school_id'));        }         else {            if ($province_id) {                $this->db->where('SC.provincial', $province_id);            }//            if ($district_id) {                $this->db->where('SC.district_id', $district_id);            }//            if ($zonal_id) {                $this->db->where('SC.zonal_id', $zonal_id);            }//            if ($edu_id) {                $this->db->where('SC.educational_id', $edu_id);            }            if ($schools_id) {                $this->db->where('S.school_id', $schools_id);            }        }                                if ($this->session->userdata('role_id') == TEACHER) {            $this->db->where('S.teacher_id', $this->session->userdata('profile_id'));        }        if ($this->session->userdata('role_id') == SUBJECT) {            $subject_id = $this->session->userdata('subject_id');            $str_area = explode(',', $subject_id);            $this->db->where_in('S.Submainid', $str_area);        }        if($this->session->userdata('role_id') == PROVINCIAL){           $provincial_id = $this->session->userdata('provincial_id');                                    $this->db->where('SC.provincial', $provincial_id);        }                  if($this->session->userdata('role_id') == ZONAL){             $zonal_id = $this->session->userdata('zonal_id');             $str_area = explode(',', $zonal_id);                        $this->db->where_in('SC.zonal_id', $str_area);        }                 if ($class_id > 0) {            $this->db->where('S.class_id', $class_id);        }//        if ($this->session->userdata('role_id') != SUPER_ADMIN) {////            $this->db->where('S.school_id', $this->session->userdata('school_id'));//        }//        if ($school_id && $this->session->userdata('role_id') == SUPER_ADMIN) {////            $this->db->where('S.school_id', $school_id);//        }        $this->db->where('SC.status', 1);        $this->db->order_by('S.id', 'DESC');        return $this->db->get()->result();    }    public function get_single_subject($id) {        $this->db->select('S.*, SC.school_name, C.School_className AS class_name, T.name AS teacher');        $this->db->from('subjects AS S');        $this->db->join('teachers AS T', 'T.id = S.teacher_id', 'left');      //  $this->db->join('classes AS C', 'C.id = S.class_id', 'left');          $this->db->join('schoolclass AS C', 'C.School_classesid = S.class_id', 'left');        $this->db->join('schools AS SC', 'SC.id = S.school_id', 'left');        $this->db->where('S.id', $id);        return $this->db->get()->row();    }    function duplicate_check($school_id, $class_id, $name, $id = null) {        if ($id) {            $this->db->where_not_in('id', $id);        }        $this->db->where('class_id', $class_id);        $this->db->where('name', $name);        $this->db->where('school_id', $school_id);        return $this->db->get('subjects')->num_rows();    }    public function listpirtype() {        $this->db->select()->from('school_type');        $listhostel = $this->db->get();        return $listhostel->result_array();    }    public function get_subject_definelist($piriventype_id = null, $subclass_id = null) {        $this->db->select('S.*, C.School_className AS class_name, SC.School_Type AS SchoolType');        $this->db->from('subject_define AS S');//        $this->db->join('teachers AS T', 'T.id = S.teacher_id', 'left');        $this->db->join('schoolclass AS C', 'C.School_classesid = S.class_id', 'left');        $this->db->join('school_type AS SC', 'SC.School_TypeId = S.pirtype', 'left');        if ($piriventype_id) {            $this->db->where('S.pirtype', $piriventype_id);        }        if ($subclass_id) {            $this->db->where('S.class_id', $subclass_id);        }        $this->db->where('S.status', 1);       // $this->db->order_by('S.id', 'DESC');        $this->db->order_by('S.id');                return $this->db->get()->result();    }    public function geteditSubjectData($id = null) {        if ($id) {            $this->db->select('S.*,C.School_className AS class_name, SC.School_Type AS SchoolType');            $this->db->from('subject_define AS S');            $this->db->join('schoolclass AS C', 'C.School_classesid = S.class_id', 'left');            $this->db->join('school_type AS SC', 'SC.School_TypeId = S.pirtype', 'left');//            $this->db->join('provincial', 'schools.provincial = provincial.provincialid', 'left');//            $this->db->join('district', 'schools.district_id = district.id', 'left');//            $this->db->join('zone', 'schools.zonal_id = zone.zoneid', 'left');//            $this->db->join('zoneblock', 'schools.educational_id = zoneblock.zoneblockid', 'left');            $this->db->where('S.id', $id);            $query = $this->db->get();            return $query->row_array();        }    }    function listclassid($School_TypeId) {        $this->db->select('C.*');        $this->db->from('subject_define AS C');        $this->db->where('C.pirtype', $School_TypeId);        return $this->db->get()->result_array();    }    function listclasstype($School_TypeId) {        $this->db->select('S.*');        $this->db->from('schoolclass AS S');        $this->db->where('S.School_Typeid', $School_TypeId);        return $this->db->get()->result_array();    }        public function getclassData($School_TypeId = null) {//        $this->db->select('schoolclass.School_classesid,schoolclass.School_className');        $this->db->from('schoolclass');        $this->db->where('schoolclass.School_Typeid', $School_TypeId);//        $query = $this->db->get();        return $query->result();    }         public function getdistrictData($provincial_id = null) {//        $this->db->select('district.id,district.districtname');        $this->db->from('district');        $this->db->where('district.provinceid', $provincial_id);//        $query = $this->db->get();        return $query->result();    }                public function getzonalData($zonal_id = null) {        $str_area = explode(',', $zonal_id);//        $this->db->select('zoneblock.zoneblockid,zoneblock.zoneblock');        $this->db->from('zoneblock');        $this->db->where_in('zoneblock.zoneid', $str_area);//        $query = $this->db->get();        return $query->result();    }}