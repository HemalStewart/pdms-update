<?phpif (!defined('BASEPATH'))    exit('No direct script access allowed');class School_Model extends MY_Model {    function __construct() {        parent::__construct();    }    function duplicate_check($school_name, $id = null) {        if ($id) {            $this->db->where_not_in('id', $id);        }        $this->db->where('school_name', $school_name);        return $this->db->get('schools')->num_rows();    }    public function get_single_school($id) {        $this->db->select('P.provincialname,DI.districtname,Z.zonename,ZB.zoneblock');        $this->db->from('schools AS SC');        $this->db->join('provincial AS P', 'SC.provincial = P.provincialid', 'left');        $this->db->join('district AS DI', 'SC.district_id = DI.id', 'left');        $this->db->join('zone AS Z', 'SC.zonal_id = Z.zoneid', 'left');        $this->db->join('zoneblock AS ZB', 'SC.educational_id = ZB.zoneblockid', 'left');        $this->db->where('SC.id', $id);        return $this->db->get()->row();    }    public function listprovincial() {        $this->db->select()->from('provincial');        $listhostel = $this->db->get();        return $listhostel->result_array();    }    public function listpirtype() {        $this->db->select()->from('school_type');        $listhostel = $this->db->get();        return $listhostel->result_array();    }    public function geteditSchoolData($id = null) {        if ($id) {//            $sql = "SELECT * FROM jobcardmain WHERE jobid = ?";//            $query = $this->db->query($sql, array($id));//            return $query->row_array();            $this->db->select('schools.id,schools.school_name,schools.school_code,provincial.provincialname,district.districtname,zone.zonename,zoneblock.zoneblock,schools.provincial');            $this->db->from('schools');            $this->db->join('provincial', 'schools.provincial = provincial.provincialid', 'left');            $this->db->join('district', 'schools.district_id = district.id', 'left');            $this->db->join('zone', 'schools.zonal_id = zone.zoneid', 'left');            $this->db->join('zoneblock', 'schools.educational_id = zoneblock.zoneblockid', 'left');            $this->db->where('schools.id', $id);            $query = $this->db->get();            return $query->row_array();        }////        $this->db->select('schools.id,schools.school_name,schools.school_code,provincial.provincialname,district.districtname,zone.zonename,zoneblock.zoneblock,schools.provincial,schools.address,schools.phone,schools.email,schools.currency,schools.logo,schools.status,');        $this->db->from('schools');        $this->db->join('provincial', 'schools.provincial = provincial.provincialid', 'left');        $this->db->join('district', 'schools.district_id = district.id', 'left');        $this->db->join('zone', 'schools.zonal_id = zone.zoneid', 'left');        $this->db->join('zoneblock', 'schools.educational_id = zoneblock.zoneblockid', 'left');//        $query = $this->db->get();        return $query->result();    }    public function getprovSchoolData($school_id = null, $provincial_id = null) {//        $this->db->select('schools.id,schools.school_name,schools.school_code,provincial.provincialname,district.districtname,zone.zonename,zoneblock.zoneblock,schools.provincial,schools.address,schools.phone,schools.email,schools.currency,schools.logo,schools.status,');        $this->db->from('schools');        $this->db->join('provincial', 'schools.provincial = provincial.provincialid', 'left');        $this->db->join('district', 'schools.district_id = district.id', 'left');        $this->db->join('zone', 'schools.zonal_id = zone.zoneid', 'left');        $this->db->join('zoneblock', 'schools.educational_id = zoneblock.zoneblockid', 'left');//         if($this->session->userdata('role_id') != SUPER_ADMIN){////            $this->db->where('schools.school_id', $this->session->userdata('school_id'));//             $this->db->where('N.created_by', $user_id);////        }        if ($this->session->userdata('role_id') == SUPER_ADMIN || $this->session->userdata('role_id') == PROVINCIAL && $school_id) {            $this->db->where('schools.id', $school_id);        }        $this->db->where('schools.provincial', $provincial_id);//        $query = $this->db->get();        return $query->result();    }    public function getzonalSchoolData($zonal_id = null) {        $str_area = explode(',', $zonal_id);//        $this->db->select('schools.id,schools.school_name,schools.school_code,provincial.provincialname,district.districtname,zone.zonename,zoneblock.zoneblock,schools.provincial,schools.address,schools.phone,schools.email,schools.currency,schools.logo,schools.status,');        $this->db->from('schools');        $this->db->join('provincial', 'schools.provincial = provincial.provincialid', 'left');        $this->db->join('district', 'schools.district_id = district.id', 'left');        $this->db->join('zone', 'schools.zonal_id = zone.zoneid', 'left');        $this->db->join('zoneblock', 'schools.educational_id = zoneblock.zoneblockid', 'left');        //  $this->db->where('schools.provincial', $provincial_id);        $this->db->where_in('schools.zonal_id', $str_area);//        $query = $this->db->get();        return $query->result();    }    public function getdistrictData($provincial_id = null) {//        $this->db->select('district.id,district.districtname');        $this->db->from('district');        $this->db->where('district.provinceid', $provincial_id);//        $query = $this->db->get();        return $query->result();    }    public function getzonalData($zonal_id = null) {        $str_area = explode(',', $zonal_id);//        $this->db->select('zone.zoneid,zone.zonename');        $this->db->from('zone');      // $this->db->where_in('zone.zoneid', $str_area);//        $query = $this->db->get();        return $query->result();    }                 public function get_school_list($province_id = null, $district_id = null, $zonal_id = null, $edu_id = null , $schools_id = null) {        $this->db->select('S.*, P.provincialname,DI.districtname,Z.zonename,ZB.zoneblock');        $this->db->from('schools AS S');        $this->db->join('provincial AS P', 'S.provincial = P.provincialid', 'left');        $this->db->join('district AS DI', 'S.district_id = DI.id', 'left');        $this->db->join('zone AS Z', 'S.zonal_id = Z.zoneid', 'left');        $this->db->join('zoneblock AS ZB', 'S.educational_id = ZB.zoneblockid', 'left');                if($this->session->userdata('role_id') == ADMIN || $this->session->userdata('role_id') == GUARDIAN || $this->session->userdata('role_id') == STUDENT || $this->session->userdata('role_id') == TEACHER || $this->session->userdata('role_id') == ACCOUNTANT || $this->session->userdata('role_id') == LIBRARIN || $this->session->userdata('role_id') == RECEPTIONIST || $this->session->userdata('role_id') == STAFF || $this->session->userdata('role_id') == PROVINCIAL || $this->session->userdata('role_id') == ZONAL){                        $this->db->where('S.id', $this->session->userdata('school_id'));                                }        else{        if ($province_id) {            $this->db->where('S.provincial', $province_id);        }//        if ($district_id) {            $this->db->where('S.district_id', $district_id);        }//        if ($zonal_id) {            $this->db->where('S.zonal_id', $zonal_id);        }//        if ($edu_id) {            $this->db->where('S.educational_id', $edu_id);        }        //          if ($schools_id) {////            $this->db->where('S.id', $schools_id);//        }        }//        if ($this->session->userdata('role_id') != SUPER_ADMIN) {////            $this->db->where('T.school_id', $this->session->userdata('school_id'));//        }////////        if ($this->session->userdata('role_id') == SUPER_ADMIN && $school_id) {////            $this->db->where('T.school_id', $school_id);//        }        $this->db->where('S.status', 1);        $this->db->order_by('S.id', 'ASC');        return $this->db->get()->result();    }}